<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>[DASCTF2024八月开学季!] Crypto | Emma</title><meta name="author" content="Emma"><meta name="copyright" content="Emma"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="EZsquares 题目描述： 1234567891011121314151617from Crypto.Util.number import *from gmpy2 import *from secret import flagp&#x3D;getPrime(512)q&#x3D;getPrime(512)n0&#x3D;p**2+q**2print(&#x27;n0 &#x3D;&#x27;,n0)e&#x3D;65537n&#x3D;p*qm&#x3D;by">
<meta property="og:type" content="article">
<meta property="og:title" content="[DASCTF2024八月开学季!] Crypto">
<meta property="og:url" content="http://example.com/2024/08/28/DASCTF2024%E5%85%AB%E6%9C%88%E5%BC%80%E5%AD%A6%E5%AD%A3-Crypto/index.html">
<meta property="og:site_name" content="Emma">
<meta property="og:description" content="EZsquares 题目描述： 1234567891011121314151617from Crypto.Util.number import *from gmpy2 import *from secret import flagp&#x3D;getPrime(512)q&#x3D;getPrime(512)n0&#x3D;p**2+q**2print(&#x27;n0 &#x3D;&#x27;,n0)e&#x3D;65537n&#x3D;p*qm&#x3D;by">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Emmaaaaaaaaaaaaaaaaa/blog-img/image/logo.jpg">
<meta property="article:published_time" content="2024-08-28T09:10:38.000Z">
<meta property="article:modified_time" content="2024-08-29T12:34:20.552Z">
<meta property="article:author" content="Emma">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Emmaaaaaaaaaaaaaaaaa/blog-img/image/logo.jpg"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/Emmaaaaaaaaaaaaaaaaa/blog-img/image/safeimagekit-logo.jpg"><link rel="canonical" href="http://example.com/2024/08/28/DASCTF2024%E5%85%AB%E6%9C%88%E5%BC%80%E5%AD%A6%E5%AD%A3-Crypto/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '[DASCTF2024八月开学季!] Crypto',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-08-29 20:34:20'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/Emmaaaaaaaaaaaaaaaaa/attachments/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/icon.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/Emmaaaaaaaaaaaaaaaaa/blog-img/image/logo.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Emma"><span class="site-name">Emma</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">[DASCTF2024八月开学季!] Crypto</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-08-28T09:10:38.000Z" title="发表于 2024-08-28 17:10:38">2024-08-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-08-29T12:34:20.552Z" title="更新于 2024-08-29 20:34:20">2024-08-29</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>9分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="[DASCTF2024八月开学季!] Crypto"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h2 id="ezsquares">EZsquares</h2>
<p>题目描述： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">512</span>)</span><br><span class="line">q=getPrime(<span class="number">512</span>)</span><br><span class="line">n0=p**<span class="number">2</span>+q**<span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n0 =&#x27;</span>,n0)</span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n0 = 192573744538639130845868727014075967669513667763315934161849620531683536696376138303320681922782003088094539724238109116416456294472461075668568088688287209898850985024632463251984323888765249950269595045648435192047990940593817086918399212487934262786817996341234806934640246045717955941049031252181676005098</span></span><br><span class="line"><span class="comment"># c = 1541487946178344665369701061600511101386703525091161664845860490319891364778119340877432325104511886045675705355836238082338561882984242433897307540689460550149990099278522355182552369360471907683216881430656993369902193583200864277424101240184767762679012998894182000556316811264544736356326198994294262682</span></span><br></pre></td></tr></table></figure> 题目分析：</p>
<p>直接用sagemath自带的函数解 <code>exp:</code> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n0 = <span class="number">192573744538639130845868727014075967669513667763315934161849620531683536696376138303320681922782003088094539724238109116416456294472461075668568088688287209898850985024632463251984323888765249950269595045648435192047990940593817086918399212487934262786817996341234806934640246045717955941049031252181676005098</span></span><br><span class="line">c = <span class="number">1541487946178344665369701061600511101386703525091161664845860490319891364778119340877432325104511886045675705355836238082338561882984242433897307540689460550149990099278522355182552369360471907683216881430656993369902193583200864277424101240184767762679012998894182000556316811264544736356326198994294262682</span></span><br><span class="line">p, q = two_squares(n0)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=inverse(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c, <span class="built_in">int</span>(d), n))))</span><br><span class="line"><span class="comment"># DASCTF&#123;4028d59bb18028e2df8d5d51b376908c&#125;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="ezmatrix">EZmatrix</h2>
<p>题目描述：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">part = [bytes_to_long(flag[<span class="number">16</span>*i:<span class="number">16</span>*(i+<span class="number">1</span>)]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>)]</span><br><span class="line">M = Matrix(Zmod(n),[</span><br><span class="line">[part[<span class="number">6</span>*i+j] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)</span><br><span class="line">])</span><br><span class="line">d = getPrime(<span class="number">920</span>)</span><br><span class="line">phi = <span class="string">&quot;???????????????????&quot;</span></span><br><span class="line">e = inverse(d,phi)</span><br><span class="line">C = M ** e</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e = &quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;C = &quot;</span>,<span class="built_in">list</span>(C))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">e =  75759282367368799544583457453768987936939259860144125672621728877894789863642594830153210412190846168814565659154249521465974291737543527734700545818480398345759102651419148920347712594370305873033928263715201812217658781693392922382633382112810845248038459857654576967447255765379492937162044564693535012144718871564964154729561032186045816489683161588345299569985304078255628527588710513640102450308662163641732851643593090646321420800552303398630738674858967724338819227042384745213425656939930135311339542647104499427215254435723921505189649944059658797193927706249542240737884739119223756635540945563449010120382834036979025801446796614280064172405549502694658175837126702821804106928800917035327292099385809060363635737715320709749444795680950552240184529017581997661357846852201424248086080872655164246614710423850620222735225702427025180018637830386631573912505087046428427137407828859500285127835020183526681560129322020299774376860830513167598911105104946612301909005028216010756378307303924865571457872055817289904093797943893894249094212422766513999129665299858860878710920689322752152527130981697461526170099006972245891313788064563118647308122107999430867808150749979046611265769861111738145184897880080810883790769899</span></span><br><span class="line"><span class="string">n =  99231341424553040688931525316017803824870567327100041969103204566938549582832516706206735181835068382521133899811339836861525260134721134887446163174620592328661881621312114348726944317349680760092960665800660405612177225373482880941142930135489885221592416840149732795379174704611605960303340578163595465083</span></span><br><span class="line"><span class="string">C =  [(60962492392910372655829579800623350869143417412923809005355225641547310999689300067771076642840347631213921261735160280073159348909580620372515144615183619484116931277062459534426852453669020768212186583219050186476749582255169630649290603191487938394564254993928830585225872994041844749592189414050346998498, 47570494768722430855321464941025696993380565713448923284620084505935271175106089198810572053594395338695564872188782440522323916637635901100372244111566233734761590240981688569861120646443206802056135646056594081150032676095454677651908656653983161086373605006880681566863747858292744224442976621418797205399, 2688181329187093888869457776665971472383024590564085347482816443420850842347573980241749337291795284050213197900458997704783513811033569074013164405426061208943782009246429930688449460037973029867946269202889059604686278471272132218340037450771429686919881716403514347492132483441838117219973263406807217974, 69152734772841729744864181378357911157430121423043131526556925765272499517864120668258106865684921607378129493604079173227751534891590136750575722628168425004031909583828469631788511241718967754283602045554638710656882949816656201393892265416912928916418003936183428716201442550333656679935723677385561024921, 87916597194547447124625284021545845894398798075569904698700457948229723401310121661631733143462834474179528341099541302790092417595967636978700000869424652408571342615122171893834241191682257315189450299073036702171002969055277890180093192346807050020075074678160917020003175299572457770301172013554859610885, 87786307503376954316030650346838348696800737186248037233105303922917125487679342882764384018020917373783494097970572084301842435397667036289687253696282531883479674194433525871169279787175003732384644823866404707423021568914833613783558731218680259786594673087000922732933203580338582174836542335256895112774), (19925935729162396840966340912353714097004160798615839580675147896543197999100114040514331382227016633727621399922875280921939403294675089237685490824481702911947235694589943642920569884248825154743655331893278941153597853907070809496035573765953115001007513406579011860142499904738601402936261081671704883289, 58482679161881651450519578125499657069493057728415805326447380380141486533923095749022382883536937182057631317376727990670863971670749991637396946761762614232393617646003704455294405699238388026259395339494678908761885707645569206191899296873833133914051981244247283254577922595285757876026540914747153605160, 7876769535761750153866264956186319035785652316141088148036849233806135397857747677246966644027825150213665232397824678749874814778004967045900692519991198396803997342682950493474998693632762775853085063006163824393616781789234994435613494739078376441202546497376889898623686582966994626392473756048641752814, 40374752091452840478156903709507048899177048294570218656121556350119195781557565218138424538202862806990185673750490061744496157480684671895195643247659670629323773035075555928457149898576983418457948777991721866891250461708466719417665721953156700367709890061169794698483650373164167487545578780062511325698, 4123966761831135761457937397066767492577970106907260057338733132356073163290362041428543487785541800166623333444500095074624068090394361249458065855973762485004782025486942019551010253665248191341796357273736185376285833313657930327592630423321995683340268803166901859312919131785819655040568361583085676057, 27583730178148494208215582336953731428677655384934947406110969819755861309635715916436503750399886946834588631955424622786954747202685007199149082525818506387606813299614560669074223670606725332129580433663793218302408230595218329795347716963182007259165979155950826829268655927501949206255488502388472700075), (56315845708240095082772501761675446313947442745181474765872020399653138411744471022394674490163519262253419142994958571123783825827944495254330717218087742852853691152509996374039921954037271141012224417462582306680805308244999271694256058220813474581635472407864886498830142166123949972548432270703952960923, 32896154872958176487612097856128071067779298934826306391422436791812001537876365873180665334382055349578758924117227229354892419126981829368419291413849009911423713613087552037524220081917635206657387768281003765094819963853123278586621439766100307324554778715337379588648264826773884692017793176376154675501, 28403727117575806889742293164072634954876499471182701829204385629161049158547263968390684814088323042021380910604906904467751008743919604654911693492973603888427448583482505774314038985928231290890291117425907291509663229092491530818877566758210084483466899541610500708571206332019126409191398637035395635692, 7821951828810668315162755325480202107754899640542890161681114897656891485110009850481857086945730357655734989848039495868447513739566035840945273281198690239884406844038006297455016615584047106189557019820282710249181355660515976689844733069965635239977868606412950428777686615619878916256034858820314322668, 76525192903457309209366743987447032158337732768547571793488111729224008602119438154849638971504949003719786026252648739617917436256435628300010323711153402229164528979259259214627588535459760359253880641429469562048622701982862831594514336875830284504454333566487968184255876886415003174627552219974082980636, 30637464791180430144279994098478365983230561289862073957684155866766012864169717451278445846218491051030419180119954192685431439312797317764656461287947635921370686618109628728836641249249386071858927735736888632316823543835130338563924434711937538665035969023712380857260473274001732469412322752873384968601), (10730358875712453042013970789576402939218800351221446191771233177536009349624025030667973532521911666593354783762941362456771050299436815799063691625091095782507693177746119034551757951243518170991606414822107132916004609627849551446847131359143181119565430368982878108761799084029033027032755115381679417096, 24507369071589713103970720335832744954845520380398828656842561115495704802037030133393011751145702976684589338927049344552393322139237977140642967325628644800492714995845105460369698708659335653391904302955502145025551463160676476446189657801618085294176671181454800483878164016749534940141884944397289890871, 92820108862600030043211342419176390123942091097153321737988513673868731991771619676009296651860321326370172965558922130850493512979555339094561381645396270883677588661828281447106070801829307329117814743685760943125981155705527918307567109500089138120007989551366153992391010620955360882383556542559392894262, 74641576048678849575812629186393953979307695146586927788280165573903662821064189347983936198087197963380651069815352351349775566210254797203960521484844402002602126951649571328507275278196835502471467819034725531964918681611446773963678730681425674462738816516031202042449731753950180027830876790421576081225, 66685821407492303211977447210040267021195326010645045932118328414906080616013267240390961550749369776862683674842903750593917463844615658362977613737130311357170777497628656513144020197746398798679807363859886437403991016453908185102814636772479260178297629433510961788244743608125906745012445887428376915629, 37645288166396858415565430454995281883016537193725289151596326083427351314771501111923193754508050507668744794821015166055917903051072319801945727142824029386542877351207944394255175419467949702189317844980323590614559226315219797417693447676522076956364574845889800486817292590561738321483697160713821529546), (9736711624136652052770116447223295880053359374932369087990200046581983386760557572632286124794444930134179594903564091220200006471388531967010990324827682059485960618855287386961552241259199988445679075595951186424593845864059162998542185539998139746836413273921569266377169025136169016355692767128488900477, 13089476325068401303987570656586592581224347700750455041713556437672762444853346450009029644985692097286649094772508755542691510307531122589433151470493395688605259544275677288082873918929554397272543678133089309672143858040052870098814015145664055945998991679722753687104989489973852117933261358247564988071, 61284598700800926964424249048307178141566077849519756690996988745704530644294308600472621437373651397677668023765897304421576611779363230148263097867987781840048890597647956492658737562151147335685622316577395377277998529914754048562837674418322097396064634364367313407061824216514715793677445932930269152481, 61301319985121628512628256322255391212515053807722664632938090246192955763394429545800696862309263991966900735678875111077481123759702692720133903430321183178233894849098114454863008686201888641863850157441070304164754292432907144839124698488730051010247980425937242664545487287543260612682886985351085138001, 47435322189871012567009786652825469952862610804330828872313845269622590943796389601479086952212526668296575803391674745677862994957044749158154034984601827088557466296368252473168676311089972605318362738347163748086202789713353987691976193103958097243650266229294687864565520648709873760054473254540098351391, 32817913908586741358496040992834207477154835734595147264489781242919114343572982132460531399879345665767073663537263426565698777735998027473421290120433416805825431315476774452072722260737533264180361001819202057517709886953362750990747046346025917668519097056756157788411735612581204089155228884131378072233), (12642425264267098423833241400926732957307073786117649292717736141221694320062979757108242390714162456346780855636174573171779655212347730635821416215537084671118355916330992142141813099104775940725892721614126911510988568345398817554586646066735943804403563179908909629802981392776238272786744291004069356775, 32752716826697049825682788062896730338057604164648704588810956358313907785865814197561208570319757370744105618622052812423057447877481397095444475610617492626525875388680227635541658500637643262806846291312209615044898925278862926827256312481616510480170805540775256088922398310392639344678087647083653765821, 3022511069721965916815622985038080358228403264264831484927372260512043862778138035440859308822033467592971930633307565996150364843965884881400481310689834508879168477508572967173126034539725429899016318805136722734731136521866714013050522337795295311863953350784370773653485436181314864092331268367915892666, 44494293452595159373079306455244053834138260846967620303725161277545981351217523341157156495183639822519882035281721714315331475283644457723353767200184408989752610854962070029226464081899523388838531578296754646973186313035869250105084114692966907900349716132438711767401573694320357418158987949401765528425, 66130193533773704471809811407675367482896080993725170656227230634400122250448911267627547029162335780439769273413020435641724884803365183531498010730643595588304390566255555816793888715047993688213860064650538998545316010718479287163068234420541010586467244361311016741807424118408290204453770332676360498896, 74649855891297747785048523345822478110464591680545397129030301786991725968732851407232435476064324066227685639784066521927825943853534396958155065514682624920312291149309530337681973006060504366672574864594730979571926592855426800301765737184843799883674936189745414847240093702374870446528449267420369306618)]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>题目分析：</p>
<p>连分数解吧</p>
<p><a
target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/rsa/d_attacks/rsa_extending_wiener/">维纳攻击（连分数）</a></p>
<p><code>exp1:</code> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continuedFra</span>(<span class="params">x, y</span>):</span><br><span class="line">    cf = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cf.append(x // y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cf</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    numerator = <span class="number">0</span> <span class="comment"># 分子</span></span><br><span class="line">    denominator = <span class="number">1</span> <span class="comment"># 分母</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> cf[::-<span class="number">1</span>]:</span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> numerator, denominator</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getGradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    gf = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(cf) + <span class="number">1</span>):</span><br><span class="line">        gf.append(gradualFra(cf[:i]))</span><br><span class="line">    <span class="keyword">return</span> gf</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wienerAttack</span>(<span class="params">e, n</span>):</span><br><span class="line">    cf = continuedFra(e, n)</span><br><span class="line">    gf = getGradualFra(cf)</span><br><span class="line">    <span class="keyword">for</span> d,k <span class="keyword">in</span> gf:</span><br><span class="line">        <span class="keyword">if</span> d.bit_length() == <span class="number">920</span> <span class="keyword">and</span> isPrime(d):</span><br><span class="line">            <span class="built_in">print</span>(d)</span><br><span class="line">e =  <span class="number">75759282367368799544583457453768987936939259860144125672621728877894789863642594830153210412190846168814565659154249521465974291737543527734700545818480398345759102651419148920347712594370305873033928263715201812217658781693392922382633382112810845248038459857654576967447255765379492937162044564693535012144718871564964154729561032186045816489683161588345299569985304078255628527588710513640102450308662163641732851643593090646321420800552303398630738674858967724338819227042384745213425656939930135311339542647104499427215254435723921505189649944059658797193927706249542240737884739119223756635540945563449010120382834036979025801446796614280064172405549502694658175837126702821804106928800917035327292099385809060363635737715320709749444795680950552240184529017581997661357846852201424248086080872655164246614710423850620222735225702427025180018637830386631573912505087046428427137407828859500285127835020183526681560129322020299774376860830513167598911105104946612301909005028216010756378307303924865571457872055817289904093797943893894249094212422766513999129665299858860878710920689322752152527130981697461526170099006972245891313788064563118647308122107999430867808150749979046611265769861111738145184897880080810883790769899</span></span><br><span class="line">n =  <span class="number">99231341424553040688931525316017803824870567327100041969103204566938549582832516706206735181835068382521133899811339836861525260134721134887446163174620592328661881621312114348726944317349680760092960665800660405612177225373482880941142930135489885221592416840149732795379174704611605960303340578163595465083</span></span><br><span class="line">wienerAttack(e,n ** <span class="number">4</span>)</span><br></pre></td></tr></table></figure> <span
class="math inline">\(为什么是n^4，文章里面说的挺清楚的：\)</span></p>
<p><img
src="https://cdn.jsdelivr.net/gh/Emmaaaaaaaaaaaaaaaaa/blog-img/image/202408292031653.png" /></p>
<p><span class="math inline">\(题目中当N = n^4时，e \approx
N，故用n^4（满足条件d &lt; \frac{\sqrt{2}}{2g}N^{\frac{1}{4}} =
\frac{\sqrt{2}}{2g}n）\)</span></p>
<p>哎呀，一开始一直弄那个phi，矩阵的phi这里我确实不是很懂，后面知道了但发现我压根不知道p,q，求出来了phi也没用啊，所以就
换个思路啦</p>
<blockquote>
<p>如果给了p，q，且 e = getPrime(1024) 那么（6阶矩阵）：</p>
<p>order_p = p * (p - 1) * (p + 1) * (p ^ 2 + 1) * (p ^ 2 + p + 1) * (p
^ 2 - p + 1) * (p ^ 5 - 1)</p>
<p>order_q = q * (q - 1) * (q + 1) * (q ^ 2 + 1) * (q ^ 2 + q + 1) * (q
^ 2 - q + 1) * (q ^ 5 - 1)</p>
<p>phi = order_p * order_q</p>
</blockquote>
<h2 id="ezsignin">EZsignin</h2>
<p>题目描述：</p>
<p><code>task.py</code> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">p = <span class="number">174523845247570741054964008585718839267</span></span><br><span class="line">E = EllipticCurve(GF(p), [<span class="number">0</span>, <span class="number">486662</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">G=E(<span class="number">2247961404505753398791635923994899528</span>, <span class="number">108711418033303501028455466081133667288</span>)</span><br><span class="line">n=G.order()</span><br><span class="line">Cofactor = E.order() // n</span><br><span class="line">f = <span class="number">128</span>+<span class="number">1</span></span><br><span class="line">lambda_ = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">retbar</span>(<span class="params">P</span>):</span><br><span class="line">    index = (f + <span class="number">1</span>) // <span class="number">2</span> <span class="comment"># 65</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">int</span>(P[<span class="number">0</span>]) % (<span class="number">2</span> ^ index) + <span class="number">2</span> ^ index) % n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>():</span><br><span class="line">    w = randint(<span class="number">1</span>, n - <span class="number">1</span>)</span><br><span class="line">    W = w * G</span><br><span class="line">    <span class="keyword">return</span> (w, W)</span><br><span class="line"></span><br><span class="line">B_pri_w, B_pub_W = genkey()</span><br><span class="line"><span class="built_in">print</span>(B_pub_W[<span class="number">0</span>:<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">LS = []</span><br><span class="line">LR = []</span><br><span class="line">BR = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Exchange</span>(<span class="params">i</span>): <span class="comment"># 10</span></span><br><span class="line">    A_pri_w, A_pub_W = genkey()</span><br><span class="line">    A_pri_r, A_pub_R = genkey()</span><br><span class="line">    B_pri_r, B_pub_R = genkey()</span><br><span class="line"></span><br><span class="line">    sa = (A_pri_r + retbar(A_pub_R) * A_pri_w) % n</span><br><span class="line">    sb = (B_pri_r + retbar(B_pub_R) * B_pri_w) % n</span><br><span class="line"></span><br><span class="line">    Ka = Cofactor * (B_pub_R + retbar(B_pub_R) * B_pub_W) * sa</span><br><span class="line">    Kb = Cofactor * (A_pub_R + retbar(A_pub_R) * A_pub_W) * sb</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> (Ka == Kb)</span><br><span class="line"></span><br><span class="line">    leakageS = sb &gt;&gt; lambda_</span><br><span class="line">    leakageR = B_pri_r &gt;&gt; lambda_</span><br><span class="line"></span><br><span class="line">    LS.append(leakageS), LR.append(leakageR)</span><br><span class="line">    BR.append(B_pub_R[<span class="number">0</span>:<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>): Exchange(i)</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;LS=&quot;</span>, LS)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;LR=&quot;</span>, LR)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;BR=&quot;</span>, BR)</span><br><span class="line">H=hashlib.md5()</span><br><span class="line">H.update(long_to_bytes(B_pri_w))</span><br><span class="line">key=H.hexdigest().encode()</span><br><span class="line">aes = AES.new(key,AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(aes.encrypt(flag))</span><br></pre></td></tr></table></figure> <code>secret.txt</code>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">56142839234500040174315077324489019612</span>, <span class="number">143186177525574678948140963663687495447</span>)</span><br><span class="line">LS= [<span class="number">12160779</span>, <span class="number">70634852</span>, <span class="number">136488679</span>, <span class="number">93279448</span>, <span class="number">51769705</span>, <span class="number">99408367</span>, <span class="number">94011238</span>, <span class="number">46255543</span>, <span class="number">136054320</span>, <span class="number">126842658</span>]</span><br><span class="line">LR= [<span class="number">117789932</span>, <span class="number">85602320</span>, <span class="number">136131278</span>, <span class="number">85538539</span>, <span class="number">33115646</span>, <span class="number">15821127</span>, <span class="number">122073977</span>, <span class="number">40205177</span>, <span class="number">40509142</span>, <span class="number">121833940</span>]</span><br><span class="line">BR= [(<span class="number">43128875586771925869851532015581155657</span>, <span class="number">108714366549720544283054523544596695631</span>), (<span class="number">166053844834143846221197595138208659402</span>, <span class="number">9389299139547698081250285594708260233</span>), (<span class="number">83160043610860066750778648875060399604</span>, <span class="number">160655466348101518011620435983302563358</span>), (<span class="number">18306927902958362110653472691194540502</span>, <span class="number">141566997533915037448387258113883793369</span>), (<span class="number">124719869188706449552550102421264489653</span>, <span class="number">111266021208672789646176095367638959348</span>), (<span class="number">62115794167524204331339724293036031704</span>, <span class="number">24476842210910012261000793337134128911</span>), (<span class="number">57017187772347635647835418540384524017</span>, <span class="number">149273114828279413180900590599119201032</span>), (<span class="number">141865913804035015431129030802262884043</span>, <span class="number">11219445710980991629921733217597739715</span>), (<span class="number">35994282847505215202392163277052083355</span>, <span class="number">5366425669461724819918825109516828913</span>), (<span class="number">72621299937996657982583201267406651177</span>, <span class="number">39297013522202608324989011761142875947</span>)]</span><br><span class="line"><span class="string">b&#x27;\xd7\x8c\xf1Yx\x05W\x8ckq\xfdb\xd5\x81K&quot;\xe7q\x88\x18\xedq\x9f\xcap\x1cTB\xc9)\xe1c\xf4~\x7f\xccwh\xfe\t\xbf\xb2!\xde\x84\xeeO\x0f8\xd1\xac\xbc\x1c \xf0F\x0c\x00\xc9\xa7\x9e\x06\xdan&#x27;</span></span><br></pre></td></tr></table></figure> 题目分析：</p>
<p>代码很多行，但逻辑很简单</p>
<p><span class="math inline">\(W_b = w_b * G\)</span></p>
<p><span class="math inline">\(W_b和G都给了，要求w_b\)</span></p>
<p>又有： <span class="math display">\[
\begin{align*}
&amp;W_{a} = w_{a} * G\\
&amp;R_{a} = r_{a} * G\\
&amp;R_{b} = r_{b} * G\\
&amp;S_{b} = r_{b} + w_{b} * f(R_{b})\\
&amp;其中S_{b}, r_{b}的高94bit已知，f(R_b)已知，求w_{b}\\
&amp;变一下：\\
&amp;(S_{bh} + S_{bl}) = (r_{bh} + r_{bl}) + w_{b} * f(R_b)\\
&amp;再变一下：\\
&amp;(S_{bl} - r_{bl}) = f(R_b) * w_b + (r_{bh} - S_{bh})\\
&amp;一眼HNP\\
&amp;化成这种形式：k_i \equiv A_i * x + B_i \pmod n\\
&amp;令(S_{bl} - r_{bl}) = k_i, f(R_b) = A_i,  (r_{bh} - S_{bh}) = B_i\\
&amp;其中k_i, A_i, B_i均已知，k_i—100bit；A_i—66bit；B_i—(94 +
100)bit；x,n—128bit
\end{align*}
\]</span> 构造如下格： <span class="math display">\[
M=\begin{pmatrix}n\\&amp;\ddots\\&amp;&amp;n\\A_1&amp;\cdots&amp;A_{10}&amp;\frac{2^{100}}{2^{128}}\\B_1&amp;\cdots&amp;B_{10}&amp;&amp;2^{100}\end{pmatrix}
\]</span> Z为自己需要构造的数（确保目标向量中所有元素大小与<span
class="math inline">\(k_i\)</span>相近）</p>
<p><span
class="math inline">\(\begin{pmatrix}l_1&amp;\cdots&amp;l_i&amp;x&amp;1\end{pmatrix}\times
M=\begin{pmatrix}k_1&amp;\cdots&amp;k_i&amp;2^{100}/2^{128}*x&amp;2^{100}\end{pmatrix}\)</span></p>
<p><code>exp1:</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">174523845247570741054964008585718839267</span></span><br><span class="line">E = EllipticCurve(GF(p), [<span class="number">0</span>, <span class="number">486662</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">G=E(<span class="number">2247961404505753398791635923994899528</span>, <span class="number">108711418033303501028455466081133667288</span>)</span><br><span class="line">n=G.order()</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line">Cofactor = E.order() // n</span><br><span class="line">f = <span class="number">128</span>+<span class="number">1</span></span><br><span class="line">lambda_ = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">retbar</span>(<span class="params">P</span>):</span><br><span class="line">    index = (f + <span class="number">1</span>) // <span class="number">2</span> <span class="comment"># 65</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">int</span>(P[<span class="number">0</span>]) % (<span class="number">2</span> ^ index) + <span class="number">2</span> ^ index) % n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>():</span><br><span class="line">    w = randint(<span class="number">1</span>, n - <span class="number">1</span>)</span><br><span class="line">    W = w * G</span><br><span class="line">    <span class="keyword">return</span> (w, W)</span><br><span class="line"></span><br><span class="line">WB = E(<span class="number">56142839234500040174315077324489019612</span>, <span class="number">143186177525574678948140963663687495447</span>)</span><br><span class="line">LS= [<span class="number">12160779</span>, <span class="number">70634852</span>, <span class="number">136488679</span>, <span class="number">93279448</span>, <span class="number">51769705</span>, <span class="number">99408367</span>, <span class="number">94011238</span>, <span class="number">46255543</span>, <span class="number">136054320</span>, <span class="number">126842658</span>]</span><br><span class="line">LR= [<span class="number">117789932</span>, <span class="number">85602320</span>, <span class="number">136131278</span>, <span class="number">85538539</span>, <span class="number">33115646</span>, <span class="number">15821127</span>, <span class="number">122073977</span>, <span class="number">40205177</span>, <span class="number">40509142</span>, <span class="number">121833940</span>]</span><br><span class="line">BR= [(<span class="number">43128875586771925869851532015581155657</span>, <span class="number">108714366549720544283054523544596695631</span>), (<span class="number">166053844834143846221197595138208659402</span>, <span class="number">9389299139547698081250285594708260233</span>), (<span class="number">83160043610860066750778648875060399604</span>, <span class="number">160655466348101518011620435983302563358</span>), (<span class="number">18306927902958362110653472691194540502</span>, <span class="number">141566997533915037448387258113883793369</span>), (<span class="number">124719869188706449552550102421264489653</span>, <span class="number">111266021208672789646176095367638959348</span>), (<span class="number">62115794167524204331339724293036031704</span>, <span class="number">24476842210910012261000793337134128911</span>), (<span class="number">57017187772347635647835418540384524017</span>, <span class="number">149273114828279413180900590599119201032</span>), (<span class="number">141865913804035015431129030802262884043</span>, <span class="number">11219445710980991629921733217597739715</span>), (<span class="number">35994282847505215202392163277052083355</span>, <span class="number">5366425669461724819918825109516828913</span>), (<span class="number">72621299937996657982583201267406651177</span>, <span class="number">39297013522202608324989011761142875947</span>)]</span><br><span class="line">ct = <span class="string">b&#x27;\xd7\x8c\xf1Yx\x05W\x8ckq\xfdb\xd5\x81K&quot;\xe7q\x88\x18\xedq\x9f\xcap\x1cTB\xc9)\xe1c\xf4~\x7f\xccwh\xfe\t\xbf\xb2!\xde\x84\xeeO\x0f8\xd1\xac\xbc\x1c \xf0F\x0c\x00\xc9\xa7\x9e\x06\xdan&#x27;</span></span><br><span class="line"></span><br><span class="line">M = matrix(QQ, <span class="number">12</span>, <span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    M[i, i] = n</span><br><span class="line">    M[-<span class="number">2</span>, i] = retbar(BR[i])</span><br><span class="line">    M[-<span class="number">1</span>, i] = (LR[i] &lt;&lt; lambda_) - (LS[i] &lt;&lt; lambda_)</span><br><span class="line">M[-<span class="number">2</span>, -<span class="number">2</span>] = <span class="number">2</span> ** <span class="number">100</span> / <span class="number">2</span> ** <span class="number">128</span></span><br><span class="line">M[-<span class="number">1</span>, -<span class="number">1</span>] = <span class="number">2</span> ** <span class="number">100</span></span><br><span class="line"></span><br><span class="line">L = M.LLL()</span><br><span class="line"><span class="built_in">print</span>(L)</span><br><span class="line">res = L[<span class="number">2</span>][-<span class="number">2</span>] / (<span class="number">2</span> ** <span class="number">100</span> / <span class="number">2</span> ** <span class="number">128</span>) % n</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># 1178130499626730132053516695382476673</span></span><br></pre></td></tr></table></figure>
<p>到这里就一直出不来了，那就是求到的x有问题</p>
<p>开始测试，发现不管怎么样求到的x的后36bit是不准的</p>
<p>所以题目中的数据得到的x低36bit应该也是有问题的</p>
<p>这时候<code>B_pub_W[0:2]</code>的作用就出来了（我说呢，为什么会把这个给出来）</p>
<p>所以问题变成了：<span class="math inline">\(W_b = (w&#39;_b + k) *
G\)</span>，其中 <span class="math inline">\(W_b，w&#39;_b，G\)</span>
已知且 <span class="math inline">\(k\)</span> 为36bit，求 <span
class="math inline">\(k\)</span></p>
<p><span class="math inline">\(k是36bit\)</span>
不大，我们使用中间相遇攻击进行求解 <span class="math display">\[
\begin{align*}
&amp;令T = (W_b - w&#39;_b) * G = k * G = (k_h * 2^{18} + k_l) * G\\
&amp;其中k_h为k的高18bit，k_l为k的低18bit\\
&amp;T = (k_h * 2^{18} + k_l) * G\\
&amp;T - k_l * G = k_h * 2^{18} * G (此刻即为相遇的位置)\\
&amp;之后爆破k_l和k_h即可
\end{align*}
\]</span></p>
<p><code>完整exp:</code> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># part1</span></span><br><span class="line">p = <span class="number">174523845247570741054964008585718839267</span></span><br><span class="line">E = EllipticCurve(GF(p), [<span class="number">0</span>, <span class="number">486662</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">G=E(<span class="number">2247961404505753398791635923994899528</span>, <span class="number">108711418033303501028455466081133667288</span>)</span><br><span class="line">n=G.order()</span><br><span class="line">Cofactor = E.order() // n</span><br><span class="line">f = <span class="number">128</span>+<span class="number">1</span></span><br><span class="line">lambda_ = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">retbar</span>(<span class="params">P</span>):</span><br><span class="line">    index = (f + <span class="number">1</span>) // <span class="number">2</span> <span class="comment"># 65</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">int</span>(P[<span class="number">0</span>]) % (<span class="number">2</span> ^ index) + <span class="number">2</span> ^ index) % n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>():</span><br><span class="line">    w = randint(<span class="number">1</span>, n - <span class="number">1</span>)</span><br><span class="line">    W = w * G</span><br><span class="line">    <span class="keyword">return</span> (w, W)</span><br><span class="line"></span><br><span class="line">WB = E(<span class="number">56142839234500040174315077324489019612</span>, <span class="number">143186177525574678948140963663687495447</span>)</span><br><span class="line">LS= [<span class="number">12160779</span>, <span class="number">70634852</span>, <span class="number">136488679</span>, <span class="number">93279448</span>, <span class="number">51769705</span>, <span class="number">99408367</span>, <span class="number">94011238</span>, <span class="number">46255543</span>, <span class="number">136054320</span>, <span class="number">126842658</span>]</span><br><span class="line">LR= [<span class="number">117789932</span>, <span class="number">85602320</span>, <span class="number">136131278</span>, <span class="number">85538539</span>, <span class="number">33115646</span>, <span class="number">15821127</span>, <span class="number">122073977</span>, <span class="number">40205177</span>, <span class="number">40509142</span>, <span class="number">121833940</span>]</span><br><span class="line">BR= [(<span class="number">43128875586771925869851532015581155657</span>, <span class="number">108714366549720544283054523544596695631</span>), (<span class="number">166053844834143846221197595138208659402</span>, <span class="number">9389299139547698081250285594708260233</span>), (<span class="number">83160043610860066750778648875060399604</span>, <span class="number">160655466348101518011620435983302563358</span>), (<span class="number">18306927902958362110653472691194540502</span>, <span class="number">141566997533915037448387258113883793369</span>), (<span class="number">124719869188706449552550102421264489653</span>, <span class="number">111266021208672789646176095367638959348</span>), (<span class="number">62115794167524204331339724293036031704</span>, <span class="number">24476842210910012261000793337134128911</span>), (<span class="number">57017187772347635647835418540384524017</span>, <span class="number">149273114828279413180900590599119201032</span>), (<span class="number">141865913804035015431129030802262884043</span>, <span class="number">11219445710980991629921733217597739715</span>), (<span class="number">35994282847505215202392163277052083355</span>, <span class="number">5366425669461724819918825109516828913</span>), (<span class="number">72621299937996657982583201267406651177</span>, <span class="number">39297013522202608324989011761142875947</span>)]</span><br><span class="line">c = <span class="string">b&#x27;\xd7\x8c\xf1Yx\x05W\x8ckq\xfdb\xd5\x81K&quot;\xe7q\x88\x18\xedq\x9f\xcap\x1cTB\xc9)\xe1c\xf4~\x7f\xccwh\xfe\t\xbf\xb2!\xde\x84\xeeO\x0f8\xd1\xac\xbc\x1c \xf0F\x0c\x00\xc9\xa7\x9e\x06\xdan&#x27;</span></span><br><span class="line">M = matrix(QQ, <span class="number">12</span>, <span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    M[i, i] = n</span><br><span class="line">    M[-<span class="number">2</span>, i] = retbar(BR[i])</span><br><span class="line">    M[-<span class="number">1</span>, i] = (LR[i] &lt;&lt; lambda_) - (LS[i] &lt;&lt; lambda_)</span><br><span class="line">M[-<span class="number">2</span>, -<span class="number">2</span>] = <span class="number">2</span> ** <span class="number">100</span> / <span class="number">2</span> ** <span class="number">128</span></span><br><span class="line">M[-<span class="number">1</span>, -<span class="number">1</span>] = <span class="number">2</span> ** <span class="number">100</span></span><br><span class="line"></span><br><span class="line">L = M.LLL()</span><br><span class="line">res = L[<span class="number">2</span>][-<span class="number">2</span>] / (<span class="number">2</span> ** <span class="number">100</span> / <span class="number">2</span> ** <span class="number">128</span>) % n</span><br><span class="line"><span class="comment"># 1178130499626730132053516695382476673 </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part2</span></span><br><span class="line">false = res &gt;&gt; <span class="number">36</span> &lt;&lt; <span class="number">36</span></span><br><span class="line">T = WB - fale * G</span><br><span class="line">tmp = T - <span class="number">2</span> ** <span class="number">17</span> * G</span><br><span class="line">tt_dict = &#123;&#125;</span><br><span class="line"><span class="comment"># kl</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span> ** <span class="number">17</span>, <span class="number">2</span> ** <span class="number">18</span>):</span><br><span class="line">    tmp -= G</span><br><span class="line">    tt_dict[tmp[<span class="number">0</span>]] = i</span><br><span class="line"></span><br><span class="line"><span class="comment"># kh</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span> ** <span class="number">17</span>, <span class="number">2</span> ** <span class="number">18</span>):</span><br><span class="line">    khG = (i &lt;&lt; <span class="number">18</span>) * G</span><br><span class="line">    <span class="keyword">if</span> khG[<span class="number">0</span>] <span class="keyword">in</span> tt_dict:</span><br><span class="line">        kh = i</span><br><span class="line">        kl = tt_dict[khG[<span class="number">0</span>]] + <span class="number">1</span></span><br><span class="line">        B_pri_w = false + (kh &lt;&lt; <span class="number">18</span>) + kl</span><br><span class="line">        H=hashlib.md5()</span><br><span class="line">        H.update(long_to_bytes(B_pri_w))</span><br><span class="line">        key=H.hexdigest().encode()</span><br><span class="line">        aes = AES.new(key,AES.MODE_ECB)</span><br><span class="line">        <span class="built_in">print</span>(aes.decrypt(c))        </span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># DASCTF&#123;C0ngRatul4tion5_On_y0ur_SuCc3ssfuL_S1gN_1n&#125;</span></span><br></pre></td></tr></table></figure> 浅记一下</p>
<p><code>关键词:</code>
two_squares(n0)，矩阵phi，维纳连分数，HNP，中间相遇</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Emma</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/08/28/DASCTF2024%E5%85%AB%E6%9C%88%E5%BC%80%E5%AD%A6%E5%AD%A3-Crypto/">http://example.com/2024/08/28/DASCTF2024%E5%85%AB%E6%9C%88%E5%BC%80%E5%AD%A6%E5%AD%A3-Crypto/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Emma</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/wp/">wp</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/Emmaaaaaaaaaaaaaaaaa/blog-img/image/logo.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF-2024-Crypto/" title="[羊城杯 2024] Crypto"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">[羊城杯 2024] Crypto</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/07/22/DASCTF-2024-%E6%9A%91%E6%9C%9F%E6%8C%91%E6%88%98%E8%B5%9B-Crypto/" title="[DASCTF 2024 暑期挑战赛] Crypto"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-22</div><div class="title">[DASCTF 2024 暑期挑战赛] Crypto</div></div></a></div><div><a href="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF-2024-Crypto/" title="[羊城杯 2024] Crypto"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-28</div><div class="title">[羊城杯 2024] Crypto</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/Emmaaaaaaaaaaaaaaaaa/blog-img/image/logo.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Emma</div><div class="author-info__description">总有人间一两风，填我十万八千梦！</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Emmaaaaaaaaaaaaaaaaa" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:2592193853@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ezsquares"><span class="toc-number">1.</span> <span class="toc-text">EZsquares</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezmatrix"><span class="toc-number">2.</span> <span class="toc-text">EZmatrix</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezsignin"><span class="toc-number">3.</span> <span class="toc-text">EZsignin</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/28/DASCTF2024%E5%85%AB%E6%9C%88%E5%BC%80%E5%AD%A6%E5%AD%A3-Crypto/" title="[DASCTF2024八月开学季!] Crypto">[DASCTF2024八月开学季!] Crypto</a><time datetime="2024-08-28T09:10:38.000Z" title="发表于 2024-08-28 17:10:38">2024-08-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/28/%E7%BE%8A%E5%9F%8E%E6%9D%AF-2024-Crypto/" title="[羊城杯 2024] Crypto">[羊城杯 2024] Crypto</a><time datetime="2024-08-28T08:42:02.000Z" title="发表于 2024-08-28 16:42:02">2024-08-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/22/DASCTF-2024-%E6%9A%91%E6%9C%9F%E6%8C%91%E6%88%98%E8%B5%9B-Crypto/" title="[DASCTF 2024 暑期挑战赛] Crypto">[DASCTF 2024 暑期挑战赛] Crypto</a><time datetime="2024-07-22T05:55:49.000Z" title="发表于 2024-07-22 13:55:49">2024-07-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/16/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" title="博客搭建">博客搭建</a><time datetime="2024-07-16T13:14:48.000Z" title="发表于 2024-07-16 21:14:48">2024-07-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/13/hello-world/" title="Hello World">Hello World</a><time datetime="2024-07-13T13:29:29.066Z" title="发表于 2024-07-13 21:29:29">2024-07-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Emma</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><script>(() => {
  const initGitalk = () => {
    const gitalk = new Gitalk(Object.assign({
      clientID: 'Ov23liLImJgwDM5LYl6o',
      clientSecret: '0eada4946254414c31dd07b917cf8eb127b72d4c',
      repo: 'blog_comments',
      owner: 'Emmaaaaaaaaaaaaaaaaa',
      admin: ['Emmaaaaaaaaaaaaaaaaa'],
      id: 'ae5452828a63abf820ed6d4ebe967aab',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async() => {
    if (typeof Gitalk === 'function') initGitalk()
    else {
      await getCSS('https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.css')
      await getScript('https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.js')
      initGitalk()
    }
  }
  
  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  if ('Gitalk' === 'Gitalk' || !true) {
    if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>